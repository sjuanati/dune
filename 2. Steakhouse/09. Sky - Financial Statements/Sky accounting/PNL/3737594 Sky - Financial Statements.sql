with
    financial_data as (
        select period, fi_id, label_tab, value
        from query_3735842 -- Maker - Profit & Loss
        union all
        select period, fi_id, label_tab, value
        from query_3739657 -- Maker - Balance Sheet
        union all
        select period, fi_id, label_tab, value
        from query_3747586 -- Maker - Protocol Capital
    ),
    pivot as (
        select
            fi_id,
            label_tab,
            max(case when period = '2026-02' then value else null end) as "2026-02 ⏳", -- current
            max(case when period = '2026-01' then value else null end) as "2026-01",
            max(case when period = '2025-12' then value else null end) as "2025-12",
            max(case when period = '2025-11' then value else null end) as "2025-11",
            max(case when period = '2025-10' then value else null end) as "2025-10",
            max(case when period = '2025-09' then value else null end) as "2025-09",
            max(case when period = '2025-08' then value else null end) as "2025-08",
            max(case when period = '2025-07' then value else null end) as "2025-07",
            max(case when period = '2025-06' then value else null end) as "2025-06",
            max(case when period = '2025-05' then value else null end) as "2025-05",
            max(case when period = '2025-04' then value else null end) as "2025-04",
            max(case when period = '2025-03' then value else null end) as "2025-03",
            max(case when period = '2025-02' then value else null end) as "2025-02",
            max(case when period = '2025-01' then value else null end) as "2025-01",
            max(case when period = '2024-12' then value else null end) as "2024-12",
            max(case when period = '2024-11' then value else null end) as "2024-11",
            max(case when period = '2024-10' then value else null end) as "2024-10",
            max(case when period = '2024-09' then value else null end) as "2024-09",  
            max(case when period = '2024-08' then value else null end) as "2024-08",
            max(case when period = '2024-07' then value else null end) as "2024-07",
            max(case when period = '2024-06' then value else null end) as "2024-06",
            max(case when period = '2024-05' then value else null end) as "2024-05",
            max(case when period = '2024-04' then value else null end) as "2024-04",
            max(case when period = '2024-03' then value else null end) as "2024-03",
            max(case when period = '2024-02' then value else null end) as "2024-02",
            max(case when period = '2024-01' then value else null end) as "2024-01",
            max(case when period = '2023-12' then value else null end) as "2023-12",
            max(case when period = '2023-11' then value else null end) as "2023-11",
            max(case when period = '2023-10' then value else null end) as "2023-10",
            max(case when period = '2023-09' then value else null end) as "2023-09",
            max(case when period = '2023-08' then value else null end) as "2023-08",
            max(case when period = '2023-07' then value else null end) as "2023-07",
            max(case when period = '2023-06' then value else null end) as "2023-06",
            max(case when period = '2023-05' then value else null end) as "2023-05",
            max(case when period = '2023-04' then value else null end) as "2023-04",
            max(case when period = '2023-03' then value else null end) as "2023-03",
            max(case when period = '2023-02' then value else null end) as "2023-02",
            max(case when period = '2023-01' then value else null end) as "2023-01",
            max(case when period = '2022-12' then value else null end) as "2022-12",
            max(case when period = '2022-11' then value else null end) as "2022-11",
            max(case when period = '2022-10' then value else null end) as "2022-10",
            max(case when period = '2022-09' then value else null end) as "2022-09",
            max(case when period = '2022-08' then value else null end) as "2022-08",
            max(case when period = '2022-07' then value else null end) as "2022-07",
            max(case when period = '2022-06' then value else null end) as "2022-06",
            max(case when period = '2022-05' then value else null end) as "2022-05",
            max(case when period = '2022-04' then value else null end) as "2022-04",
            max(case when period = '2022-03' then value else null end) as "2022-03",
            max(case when period = '2022-02' then value else null end) as "2022-02",
            max(case when period = '2022-01' then value else null end) as "2022-01"
        FROM financial_data
        group by 1, 2
    )

select
    label_tab as item,
    "2026-02 ⏳",
    "2026-01",
    "2025-12",
    "2025-11",
    "2025-10",
    "2025-09",
    "2025-08",
    "2025-07",
    "2025-06",
    "2025-05",
    "2025-04",
    "2025-03",
    "2025-02",
    "2025-01",
    "2024-12",
    "2024-11",
    "2024-10",
    "2024-09",
    "2024-08",
    "2024-07",
    "2024-06",
    "2024-05",
    "2024-04",
    "2024-03",
    "2024-02",
    "2024-01",
    "2023-12",
    "2023-11",
    "2023-10",
    "2023-09",
    "2023-08",
    "2023-07",
    "2023-06",
    "2023-05",
    "2023-04",
    "2023-03",
    "2023-02",
    "2023-01",
    "2022-12",
    "2022-11",
    "2022-10",
    "2022-09",
    "2022-08",
    "2022-07",
    "2022-06",
    "2022-05",
    "2022-04",
    "2022-03",
    "2022-02",
    "2022-01"
from pivot
order by fi_id asc
